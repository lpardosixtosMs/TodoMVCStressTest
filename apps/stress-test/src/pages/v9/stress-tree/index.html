<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>v9: Stress Tree</title>
  <script src="https://rawgit.com/flatiron/director/master/build/director.min.js"></script>
</head>

<body>
  <div id="root"></div>
</body>

<script>

  var numberOfItemsToAdd = 100;

  function runBenchmark() {
    var nativeInputValueSetter = Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype, "value").set;
    for (let i = 0; i < numberOfItemsToAdd; i++) {
      const newTodo = document.querySelector(".new-todo");
      nativeInputValueSetter.call(newTodo, `Something to do ${i}`);
      const event1 = new Event("input", { bubbles: true, cancelable: true });
      newTodo.dispatchEvent(event1);
      const ENTER_KEY_CODE = 13;
      let eventOptions = {
        bubbles: true,
        cancelable: true,
        key: "Enter",
      };
      const event = new KeyboardEvent("keydown", eventOptions);
      newTodo.dispatchEvent(event);
      console.log(newTodo);
    }

    // const checkboxes = document.querySelectorAll(".toggle");
    // console.log(checkboxes);
    // for (let i = 0; i < numberOfItemsToAdd; i++)
    //   checkboxes[i].click();

    // const deleteButtons = document.querySelectorAll(".destroy");
    // for (let i = 0; i < numberOfItemsToAdd; i++)
    //   deleteButtons[i].click();
  }

  var element_promise = new Promise((resolve) => {
    const resolveIfReady = () => {
      const element = document.querySelector("#TodoAppDiv");
      if (element) {
        window.requestAnimationFrame(() => {
          return resolve(element);
        });
      } else {
        setTimeout(resolveIfReady, 50);
      }
    };
    resolveIfReady();
  });

  element_promise.then(runBenchmark);



</script>

</html>
